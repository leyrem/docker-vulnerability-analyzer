package sarif

type Sarif struct {
	Version string `json:"version"`
	Runs    []Run  `json:"runs"`
}

type Run struct {
	Tool    Tool     `json:"tool"`
	Results []Result `json:"results"`
}

type Tool struct {
	Driver Driver `json:"driver"`
}

type Driver struct {
	FullName string `json:"fullName"`
	Name     string `json:"name"`
	Rules    []Rule `json:"rules"`
}

type Rule struct {
	ID                   string               `json:"id"`
	Name                 string               `json:"name"`
	ShortDescription     ShortDescription     `json:"shortDescription"`
	FullDescription      ShortDescription     `json:"fullDescription"`
	DefaultConfiguration DefaultConfiguration `json:"defaultConfiguration"`
	HelpUri              string               `json:"helpUri"`
	Help                 Help                 `json:"help"`
	Properties           Properties           `json:"properties"`
}

type DefaultConfiguration struct {
	Level string `json:"level"`
}
type ShortDescription struct {
	Text string `json:"text"`
}
type Help struct {
	Text     string `json:"text"`
	Markdown string `json:"markdown"`
}
type Properties struct {
	Precision         string   `json:"precision"`
	AffectedVersion   string   `json:"affected_version"`
	CVSS_V3_Severity  string   `json:"cvssV3_severity"`
	FixedVersion      string   `json:"fixed_version"`
	Purls             []string `json:"purls"`
	SecuritySeverity  string   `json:"security-severity"`
	Tags              []string `json:tags"`
	CVSS_V3_BaseScore string   `json:cvssv3_baseScore"`
}

type Result struct {
	RuleID    string     `json:"ruleId"`
	RuleIndex int        `json:"ruleIndex"`
	Kind      string     `json:"kind"`
	Level     string     `json:"level"`
	Message   Message    `json:"message"`
	Locations []Location `json:"locations"`
	Fixes     []Fix      `json:"fixes"`
}

type Message struct {
	Text string `json:"text"`
}

type Fix struct {
	Description     ShortDescription `json:"description"`
	ArtifactChanges []ArtifactChange `json:"artifactChanges"`
}

type ArtifactChange struct {
	ArtifactLocation ArtifactLocation `json:"artifactLocation"`
	Replacements     []Replacement    `json:"replacements"`
}

type Replacement struct {
	DeletedRegion   Region  `json:"deletedRegion"`
	InsertedContent Message `json:"insertedContent"`
}

type Location struct {
	PhysicalLocation PhysicalLocation `json:"physicalLocation"`
	LogicalLocation  LogicalLocation  `json:"logicalLocations"`
	Message          Message          `json:"message"`
}

type LogicalLocation struct {
	FullyQualifiedName string `json:"fullyQualifiedName"`
	Name               string `json:"name"`
}
type PhysicalLocation struct {
	ArtifactLocation ArtifactLocation `json:"artifactLocation"`
	Region           Region           `json:"region"`
}

type ArtifactLocation struct {
	URI       string `json:"uri"`
	URIBaseID string `json:"uriBaseId"`
}

type Region struct {
	StartLine   int `json:"startLine"`
	StartColumn int `json:"startColumn"`
	EndLine     int `json:"endLine"`
	EndColumn   int `json:"endColumn"`
}
