{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 0
          },
          "rules": []
        }
      },
      "results": []
    },
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 0
          },
          "rules": []
        }
      },
      "results": []
    },
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 1595
          },
          "rules": [
            {
              "id": "SNYK-GOLANG-GITHUBCOMAZUREAZURESDKFORGOSDKAZIDENTITY-7246767",
              "shortDescription": {
                "text": "Medium severity - Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') vulnerability in github.com/Azure/azure-sdk-for-go/sdk/azidentity"
              },
              "fullDescription": {
                "text": "(CVE-2024-35255) github.com/Azure/azure-sdk-for-go/sdk/azidentity@v1.4.0"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n[github.com/Azure/azure-sdk-for-go/sdk/azidentity](https://pkg.go.dev/github.com/Azure/azure-sdk-for-go/sdk/azidentity) is a module that provides Microsoft Entra ID (formerly Azure Active Directory) token authentication support across the Azure SDK. It includes a set of TokenCredential implementations, which can be used with Azure SDK clients supporting token authentication.\n\nAffected versions of this package are vulnerable to Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') in the authentication process. An attacker can elevate privileges by exploiting race conditions during the token validation steps. This is only exploitable if the application is configured to use multiple threads or processes for handling authentication requests.\r\n\r\n**Notes:**\r\n\r\n1) An attacker who successfully exploited the vulnerability could elevate privileges and read any file on the file system with SYSTEM access permissions;\r\n\r\n2) An attacker who successfully exploits this vulnerability can only obtain read access to the system files by exploiting this vulnerability. The attacker cannot perform write or delete operations on the files;\r\n\r\n3) The vulnerability exists in the following credential types: `DefaultAzureCredential` and `ManagedIdentityCredential`;\r\n\r\n4) The vulnerability exists in the following credential types:\r\n\r\n`ManagedIdentityApplication` (.NET)\r\n\r\n`ManagedIdentityApplication` (Java)\r\n\r\n`ManagedIdentityApplication` (Node.js)\n## Remediation\nUpgrade `github.com/Azure/azure-sdk-for-go/sdk/azidentity` to version 1.6.0 or higher.\n## References\n- [GitHub Commit](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/commit/fddb2c4011c79a7efda2df053ca05b87b8a1303c)\n- [GitHub Commit](https://github.com/AzureAD/microsoft-authentication-library-for-java/commit/9a07472cedbde7a1013a6fc81da91f2a2c6d67a1)\n- [GitHub Commit](https://github.com/AzureAD/microsoft-authentication-library-for-js/commit/3ee9c68d1a80bf7652e41b58ae1bf87ff64a727e)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-net/commit/2db9a0f33668ae9cf0331613e1cd612bee105e1c)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178)\n- [Microsoft Advisory](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255)\n"
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-362",
                  "gomodules"
                ],
                "cvssv3_baseScore": 5.5,
                "security-severity": "5.5"
              }
            },
            {
              "id": "SNYK-GOLANG-GITHUBCOMMOSTYNBGOGRPCCOMPRESSIONINTERNALZSTD-7247335",
              "shortDescription": {
                "text": "High severity - Uncontrolled Resource Consumption ('Resource Exhaustion') vulnerability in github.com/mostynb/go-grpc-compression/internal/zstd"
              },
              "fullDescription": {
                "text": "github.com/mostynb/go-grpc-compression/internal/zstd@v1.2.2"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n\nAffected versions of this package are vulnerable to Uncontrolled Resource Consumption ('Resource Exhaustion') through the `Decoder.DecodeAll` function. An attacker can cause rapid memory usage increases by sending specially crafted gRPC requests. \n\n**Note:**\nThis is only exploitable if attackers can send gRPC payloads to users of the affected libraries.\n\n## Workaround \nOther compression formats were not affected, users may consider switching from zstd to another format without upgrading to a newer release.\n## Remediation\nUpgrade `github.com/mostynb/go-grpc-compression/internal/zstd` to version 1.2.3 or higher.\n## References\n- [GitHub Commit](https://github.com/mostynb/go-grpc-compression/commit/629c44d3acb9624993cc7de629f47d72109e2ce5)\n"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-400",
                  "gomodules"
                ],
                "cvssv3_baseScore": 7.5,
                "security-severity": "7.5"
              }
            },
            {
              "id": "SNYK-GOLANG-GITHUBCOMMOSTYNBGOGRPCCOMPRESSIONNONCLOBBERINGZSTD-7247336",
              "shortDescription": {
                "text": "High severity - Uncontrolled Resource Consumption ('Resource Exhaustion') vulnerability in github.com/mostynb/go-grpc-compression/nonclobbering/zstd"
              },
              "fullDescription": {
                "text": "github.com/mostynb/go-grpc-compression/nonclobbering/zstd@v1.2.2"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n\nAffected versions of this package are vulnerable to Uncontrolled Resource Consumption ('Resource Exhaustion') through the `Decoder.DecodeAll` function. An attacker can cause rapid memory usage increases by sending specially crafted gRPC requests. \n\n**Note:**\nThis is only exploitable if attackers can send gRPC payloads to users of the affected libraries.\n\n## Workaround \nOther compression formats were not affected, users may consider switching from zstd to another format without upgrading to a newer release.\n## Remediation\nUpgrade `github.com/mostynb/go-grpc-compression/nonclobbering/zstd` to version 1.2.3 or higher.\n## References\n- [GitHub Commit](https://github.com/mostynb/go-grpc-compression/commit/629c44d3acb9624993cc7de629f47d72109e2ce5)\n"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-400",
                  "gomodules"
                ],
                "cvssv3_baseScore": 7.5,
                "security-severity": "7.5"
              }
            },
            {
              "id": "SNYK-GOLANG-GOLANGORGXNETHTTP2-6531285",
              "shortDescription": {
                "text": "High severity - Allocation of Resources Without Limits or Throttling vulnerability in golang.org/x/net/http2"
              },
              "fullDescription": {
                "text": "(CVE-2023-45288) golang.org/x/net/http2@v0.21.0"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n[golang.org/x/net/http2](https://pkg.go.dev/golang.org/x/net/http2) is a work-in-progress HTTP/2 implementation for Go.\n\nAffected versions of this package are vulnerable to Allocation of Resources Without Limits or Throttling when reading header data from `CONTINUATION` frames. As part of the HPACK flow, all incoming `HEADERS` and `CONTINUATION` frames are read even if their payloads exceed `MaxHeaderBytes` and will be discarded. An attacker can send excessive data over a connection to render it unresponsive.\n## Remediation\nUpgrade `golang.org/x/net/http2` to version 0.23.0 or higher.\n## References\n- [Github Commit](https://github.com/traefik/traefik/commit/099c7e9444a5d56918b8221672fc8d6a09a5d389)\n- [GitHub Commit](https://github.com/golang/net/commit/ba872109ef2dc8f1da778651bd1fd3792d0e4587)\n- [GitHub Issue](https://github.com/golang/go/issues/65051)\n- [Go Advisory](https://pkg.go.dev/vuln/GO-2024-2687)\n"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-770",
                  "gomodules"
                ],
                "cvssv3_baseScore": 7.5,
                "security-severity": "7.5"
              }
            },
            {
              "id": "SNYK-GOLANG-GOOPENTELEMETRYIOCOLLECTORCONFIGCONFIGGRPC-7216107",
              "shortDescription": {
                "text": "High severity - Improper Restriction of Operations within the Bounds of a Memory Buffer vulnerability in go.opentelemetry.io/collector/config/configgrpc"
              },
              "fullDescription": {
                "text": "(CVE-2024-36129) go.opentelemetry.io/collector/config/configgrpc@v0.94.1"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n\nAffected versions of this package are vulnerable to Improper Restriction of Operations within the Bounds of a Memory Buffer via the decompression process. An attacker can crash the system by sending specially crafted payloads that exploit the decompression logic to consume excessive memory resources.\n## PoC\n```\ndd if=/dev/zero bs=1G count=10 | zstd > poc.zst\ncurl -vv \"http://192.168.0.107:4318/v1/traces\" -H \"Content-Type: application/x-protobuf\" -H \"Content-Encoding: zstd\" --data-binary @poc.zst\n```\n## Remediation\nUpgrade `go.opentelemetry.io/collector/config/configgrpc` to version 0.102.1 or higher.\n## References\n- [GitHub Commit](https://github.com/open-telemetry/opentelemetry-collector/commit/760f773df042305bd2d92e908cedc17957f6c542)\n- [GitHub Commit](https://github.com/open-telemetry/opentelemetry-collector/commit/7dbaebb48f33cf707a069c67eed5b2b614e9913b)\n- [GitHub PR](https://github.com/open-telemetry/opentelemetry-collector/pull/10289)\n- [GitHub PR](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)\n- [Vulnerability Advisory](https://opentelemetry.io/blog/2024/cve-2024-36129)\n"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-119",
                  "gomodules"
                ],
                "cvssv3_baseScore": 8.2,
                "security-severity": "8.2"
              }
            },
            {
              "id": "SNYK-GOLANG-GOOPENTELEMETRYIOCOLLECTORCONFIGCONFIGHTTP-7216109",
              "shortDescription": {
                "text": "High severity - Improper Restriction of Operations within the Bounds of a Memory Buffer vulnerability in go.opentelemetry.io/collector/config/confighttp"
              },
              "fullDescription": {
                "text": "(CVE-2024-36129) go.opentelemetry.io/collector/config/confighttp@v0.94.1"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n\nAffected versions of this package are vulnerable to Improper Restriction of Operations within the Bounds of a Memory Buffer via the decompression process. An attacker can crash the system by sending specially crafted payloads that exploit the decompression logic to consume excessive memory resources.\n## PoC\n```\ndd if=/dev/zero bs=1G count=10 | zstd > poc.zst\ncurl -vv \"http://192.168.0.107:4318/v1/traces\" -H \"Content-Type: application/x-protobuf\" -H \"Content-Encoding: zstd\" --data-binary @poc.zst\n```\n## Remediation\nUpgrade `go.opentelemetry.io/collector/config/confighttp` to version 0.102.0 or higher.\n## References\n- [GitHub Commit](https://github.com/open-telemetry/opentelemetry-collector/commit/760f773df042305bd2d92e908cedc17957f6c542)\n- [GitHub Commit](https://github.com/open-telemetry/opentelemetry-collector/commit/7dbaebb48f33cf707a069c67eed5b2b614e9913b)\n- [GitHub PR](https://github.com/open-telemetry/opentelemetry-collector/pull/10289)\n- [GitHub PR](https://github.com/open-telemetry/opentelemetry-collector/pull/10323)\n- [Vulnerability Advisory](https://opentelemetry.io/blog/2024/cve-2024-36129)\n"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-119",
                  "gomodules"
                ],
                "cvssv3_baseScore": 8.2,
                "security-severity": "8.2"
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "SNYK-GOLANG-GITHUBCOMAZUREAZURESDKFORGOSDKAZIDENTITY-7246767",
          "level": "warning",
          "message": {
            "text": "This file introduces a vulnerable github.com/Azure/azure-sdk-for-go/sdk/azidentity package with a medium severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/awscollector"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "github.com/Azure/azure-sdk-for-go/sdk/azidentity@v1.4.0"
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-GOLANG-GITHUBCOMMOSTYNBGOGRPCCOMPRESSIONINTERNALZSTD-7247335",
          "level": "error",
          "message": {
            "text": "This file introduces a vulnerable github.com/mostynb/go-grpc-compression/internal/zstd package with a high severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/awscollector"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "github.com/mostynb/go-grpc-compression/internal/zstd@v1.2.2"
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-GOLANG-GITHUBCOMMOSTYNBGOGRPCCOMPRESSIONNONCLOBBERINGZSTD-7247336",
          "level": "error",
          "message": {
            "text": "This file introduces a vulnerable github.com/mostynb/go-grpc-compression/nonclobbering/zstd package with a high severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/awscollector"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "github.com/mostynb/go-grpc-compression/nonclobbering/zstd@v1.2.2"
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-GOLANG-GOLANGORGXNETHTTP2-6531285",
          "level": "error",
          "message": {
            "text": "This file introduces a vulnerable golang.org/x/net/http2 package with a high severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/awscollector"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "golang.org/x/net/http2@v0.21.0"
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-GOLANG-GOOPENTELEMETRYIOCOLLECTORCONFIGCONFIGGRPC-7216107",
          "level": "error",
          "message": {
            "text": "This file introduces a vulnerable go.opentelemetry.io/collector/config/configgrpc package with a high severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/awscollector"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "go.opentelemetry.io/collector/config/configgrpc@v0.94.1"
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-GOLANG-GOOPENTELEMETRYIOCOLLECTORCONFIGCONFIGHTTP-7216109",
          "level": "error",
          "message": {
            "text": "This file introduces a vulnerable go.opentelemetry.io/collector/config/confighttp package with a high severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/awscollector"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "go.opentelemetry.io/collector/config/confighttp@v0.94.1"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
