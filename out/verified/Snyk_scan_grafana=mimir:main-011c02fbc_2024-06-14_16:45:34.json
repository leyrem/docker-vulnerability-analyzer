{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 3
          },
          "rules": []
        }
      },
      "results": []
    },
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 837
          },
          "rules": [
            {
              "id": "SNYK-GOLANG-GITHUBCOMAZUREAZURESDKFORGOSDKAZIDENTITY-7246767",
              "shortDescription": {
                "text": "Medium severity - Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') vulnerability in github.com/Azure/azure-sdk-for-go/sdk/azidentity"
              },
              "fullDescription": {
                "text": "(CVE-2024-35255) github.com/Azure/azure-sdk-for-go/sdk/azidentity@v1.5.2"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n[github.com/Azure/azure-sdk-for-go/sdk/azidentity](https://pkg.go.dev/github.com/Azure/azure-sdk-for-go/sdk/azidentity) is a module that provides Microsoft Entra ID (formerly Azure Active Directory) token authentication support across the Azure SDK. It includes a set of TokenCredential implementations, which can be used with Azure SDK clients supporting token authentication.\n\nAffected versions of this package are vulnerable to Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') in the authentication process. An attacker can elevate privileges by exploiting race conditions during the token validation steps. This is only exploitable if the application is configured to use multiple threads or processes for handling authentication requests.\r\n\r\n**Notes:**\r\n\r\n1) An attacker who successfully exploited the vulnerability could elevate privileges and read any file on the file system with SYSTEM access permissions;\r\n\r\n2) An attacker who successfully exploits this vulnerability can only obtain read access to the system files by exploiting this vulnerability. The attacker cannot perform write or delete operations on the files;\r\n\r\n3) The vulnerability exists in the following credential types: `DefaultAzureCredential` and `ManagedIdentityCredential`;\r\n\r\n4) The vulnerability exists in the following credential types:\r\n\r\n`ManagedIdentityApplication` (.NET)\r\n\r\n`ManagedIdentityApplication` (Java)\r\n\r\n`ManagedIdentityApplication` (Node.js)\n## Remediation\nUpgrade `github.com/Azure/azure-sdk-for-go/sdk/azidentity` to version 1.6.0 or higher.\n## References\n- [GitHub Commit](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/commit/fddb2c4011c79a7efda2df053ca05b87b8a1303c)\n- [GitHub Commit](https://github.com/AzureAD/microsoft-authentication-library-for-java/commit/9a07472cedbde7a1013a6fc81da91f2a2c6d67a1)\n- [GitHub Commit](https://github.com/AzureAD/microsoft-authentication-library-for-js/commit/3ee9c68d1a80bf7652e41b58ae1bf87ff64a727e)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-net/commit/2db9a0f33668ae9cf0331613e1cd612bee105e1c)\n- [GitHub Commit](https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178)\n- [Microsoft Advisory](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255)\n"
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-362",
                  "gomodules"
                ],
                "cvssv3_baseScore": 5.5,
                "security-severity": "5.5"
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "SNYK-GOLANG-GITHUBCOMAZUREAZURESDKFORGOSDKAZIDENTITY-7246767",
          "level": "warning",
          "message": {
            "text": "This file introduces a vulnerable github.com/Azure/azure-sdk-for-go/sdk/azidentity package with a medium severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/bin/mimir"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "github.com/Azure/azure-sdk-for-go/sdk/azidentity@v1.5.2"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
