{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 136
          },
          "rules": [
            {
              "id": "SNYK-AMZN2023-OPENSSLLIBS-7243421",
              "shortDescription": {
                "text": "Medium severity - Resource Exhaustion vulnerability in openssl-libs"
              },
              "fullDescription": {
                "text": "(CVE-2024-2511) openssl-libs@1:3.0.8-1.amzn2023.0.11"
              },
              "help": {
                "text": "",
                "markdown": "## NVD Description\n**_Note:_** _Versions mentioned in the description apply only to the upstream `openssl-libs` package and not the `openssl-libs` package as distributed by `Amazon-Linux`._\n_See `How to fix?` for `Amazon-Linux:2023` relevant fixed versions and status._\n\nIssue summary: Some non-default TLS server configurations can cause unbounded\nmemory growth when processing TLSv1.3 sessions\n\nImpact summary: An attacker may exploit certain server configurations to trigger\nunbounded memory growth that would lead to a Denial of Service\n\nThis problem can occur in TLSv1.3 if the non-default SSL_OP_NO_TICKET option is\nbeing used (but not if early_data support is also configured and the default\nanti-replay protection is in use). In this case, under certain conditions, the\nsession cache can get into an incorrect state and it will fail to flush properly\nas it fills. The session cache will continue to grow in an unbounded manner. A\nmalicious client could deliberately create the scenario for this failure to\nforce a Denial of Service. It may also happen by accident in normal operation.\n\nThis issue only affects TLS servers supporting TLSv1.3. It does not affect TLS\nclients.\n\nThe FIPS modules in 3.2, 3.1 and 3.0 are not affected by this issue. OpenSSL\n1.0.2 is also not affected by this issue.\n## Remediation\nUpgrade `Amazon-Linux:2023` `openssl-libs` to version 1:3.0.8-1.amzn2023.0.12 or higher.  \nThis issue was patched in `ALAS2023-2024-640`.\n## References\n- [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-2511](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-2511)\n- [https://github.com/openssl/openssl/commit/7e4d731b1c07201ad9374c1cd9ac5263bdf35bce](https://github.com/openssl/openssl/commit/7e4d731b1c07201ad9374c1cd9ac5263bdf35bce)\n- [https://github.com/openssl/openssl/commit/b52867a9f618bb955bed2a3ce3db4d4f97ed8e5d](https://github.com/openssl/openssl/commit/b52867a9f618bb955bed2a3ce3db4d4f97ed8e5d)\n- [https://github.com/openssl/openssl/commit/e9d7083e241670332e0443da0f0d4ffb52829f08](https://github.com/openssl/openssl/commit/e9d7083e241670332e0443da0f0d4ffb52829f08)\n- [https://github.openssl.org/openssl/extended-releases/commit/5f8d25770ae6437db119dfc951e207271a326640](https://github.openssl.org/openssl/extended-releases/commit/5f8d25770ae6437db119dfc951e207271a326640)\n- [https://www.openssl.org/news/secadv/20240408.txt](https://www.openssl.org/news/secadv/20240408.txt)\n- [http://www.openwall.com/lists/oss-security/2024/04/08/5](http://www.openwall.com/lists/oss-security/2024/04/08/5)\n- [https://security.netapp.com/advisory/ntap-20240503-0013/](https://security.netapp.com/advisory/ntap-20240503-0013/)\n"
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-400",
                  "rpm"
                ],
                "cvssv3_baseScore": 3.7,
                "security-severity": "3.7"
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "SNYK-AMZN2023-OPENSSLLIBS-7243421",
          "level": "warning",
          "message": {
            "text": "This file introduces a vulnerable openssl-libs package with a medium severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "amazon/dynamodb-local_2.5.1/dynamodb-local"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "openssl-libs@1:3.0.8-1.amzn2023.0.11"
                }
              ]
            }
          ],
          "fixes": [
            {
              "description": {
                "text": "Upgrade to openssl-libs@1:3.0.8-1.amzn2023.0.12"
              },
              "artifactChanges": [
                {
                  "artifactLocation": {
                    "uri": "amazon/dynamodb-local_2.5.1/dynamodb-local"
                  },
                  "replacements": [
                    {
                      "deletedRegion": {
                        "startLine": 1
                      },
                      "insertedContent": {
                        "text": "openssl-libs@1:3.0.8-1.amzn2023.0.12"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 1
          },
          "rules": []
        }
      },
      "results": []
    },
    {
      "tool": {
        "driver": {
          "name": "Snyk Container",
          "properties": {
            "artifactsScanned": 64
          },
          "rules": [
            {
              "id": "SNYK-JAVA-IONETTY-6483812",
              "shortDescription": {
                "text": "Medium severity - Allocation of Resources Without Limits or Throttling vulnerability in io.netty:netty-codec-http"
              },
              "fullDescription": {
                "text": "(CVE-2024-29025) io.netty:netty-codec-http@4.1.104.Final"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n[io.netty:netty-codec-http](https://mvnrepository.com/artifact/io.netty/netty-codec-http) is a network application framework for rapid development of maintainable high performance protocol servers & clients.\n\nAffected versions of this package are vulnerable to Allocation of Resources Without Limits or Throttling due to the accumulation of data in the `HttpPostRequestDecoder`. The decoder cumulates bytes in the `undecodedChunk` buffer until it can decode a field, allowing for data to accumulate without limits.\n\nAn attacker can cause a denial of service by sending a chunked post consisting of many small fields that will be accumulated in the `bodyListHttpData` list.\n## Remediation\nUpgrade `io.netty:netty-codec-http` to version 4.1.108.Final or higher.\n## References\n- [GitHub Commit](https://github.com/netty/netty/commit/0d0c6ed782d13d423586ad0c71737b2c7d02058c)\n- [GitHub Gist](https://gist.github.com/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3)\n"
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-770",
                  "maven"
                ],
                "cvssv3_baseScore": 5.3,
                "security-severity": "5.3"
              }
            },
            {
              "id": "SNYK-JAVA-ORGJETBRAINSKOTLIN-2393744",
              "shortDescription": {
                "text": "Low severity - Information Exposure vulnerability in org.jetbrains.kotlin:kotlin-stdlib"
              },
              "fullDescription": {
                "text": "(CVE-2020-29582) org.jetbrains.kotlin:kotlin-stdlib@1.6.21"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n[org.jetbrains.kotlin:kotlin-stdlib](https://search.maven.org/artifact/org.jetbrains.kotlin/kotlin-stdlib) is a Kotlin Standard Library for JVM.\n\nAffected versions of this package are vulnerable to Information Exposure. A Kotlin application using `createTempDir` or `createTempFile` and placing sensitive information within either of these locations would be leaking this information in a read-only way to other users also on this system.\r\n\r\n**Note:** As of version 1.4.21, the vulnerable functions have been marked as deprecated. Due to still being usable, this advisory is kept as \"unfixed\".\r\n\r\n## PoC by JLLeitschuh\r\n```\r\npackage org.jlleitschuh.sandbox\r\n\r\nimport org.junit.jupiter.api.Test\r\nimport java.io.BufferedReader\r\nimport java.io.File\r\nimport java.io.IOException\r\nimport java.io.InputStreamReader\r\nimport java.nio.file.Files\r\n\r\nclass KotlinTempDirectoryPermissionCheck {\r\n    @Test\r\n    fun `kotlin check default directory permissions`() {\r\n        val dir = createTempDir()\r\n        runLS(dir.parentFile, dir) // Prints drwxr-xr-x\r\n    }\r\n\r\n    @Test\r\n    fun `Files check default directory permissions`() {\r\n        val dir = Files.createTempDirectory(\"random-directory\")\r\n        runLS(dir.toFile().parentFile, dir.toFile()) // Prints drwx------\r\n    }\r\n\r\n    @Test\r\n    fun `kotlin check default file permissions`() {\r\n        val file = createTempFile()\r\n        runLS(file.parentFile, file) // Prints -rw-r--r--\r\n    }\r\n\r\n    @Test\r\n    fun `Files check default file permissions`() {\r\n        val file = Files.createTempFile(\"random-file\", \".txt\")\r\n        runLS(file.toFile().parentFile, file.toFile()) // Prints -rw-------\r\n    }\r\n\r\n    private fun runLS(file: File, lookingFor: File) {\r\n        val processBuilder = ProcessBuilder()\r\n        processBuilder.command(\"ls\", \"-l\", file.absolutePath)\r\n        try {\r\n            val process = processBuilder.start()\r\n            val output = StringBuilder()\r\n            val reader = BufferedReader(\r\n                InputStreamReader(process.inputStream)\r\n            )\r\n            reader.lines().forEach { line ->\r\n                if (line.contains(\"total\")) {\r\n                    output.append(line).append('\\n')\r\n                }\r\n                if (line.contains(lookingFor.name)) {\r\n                    output.append(line).append('\\n')\r\n                }\r\n            }\r\n            val exitVal = process.waitFor()\r\n            if (exitVal == 0) {\r\n                println(\"Success!\")\r\n                println(output)\r\n            } else {\r\n                //abnormal...\r\n            }\r\n        } catch (e: IOException) {\r\n            e.printStackTrace()\r\n        } catch (e: InterruptedException) {\r\n            e.printStackTrace()\r\n        }\r\n    }\r\n}\r\n```\n## Remediation\nThere is no fixed version for `org.jetbrains.kotlin:kotlin-stdlib`.\n\n## References\n- [Documentation](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/create-temp-dir.html)\n- [Issue](https://youtrack.jetbrains.com/issue/KT-43306/Deprecate-createTempFile-and-createTempDir-functions-in-kotlin.io)\n- [Vulnerable Code #1](https://github.com/JetBrains/kotlin/blob/9b157fd291d581a30a3194940b0ebbb95a2fd247/libraries/stdlib/jvm/src/kotlin/io/files/Utils.kt#L14-L39)\n- [Vulnerable Code #2](https://github.com/JetBrains/kotlin/blob/9b157fd291d581a30a3194940b0ebbb95a2fd247/libraries/stdlib/jvm/src/kotlin/io/files/Utils.kt#L41-L60)\n"
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-378",
                  "maven"
                ],
                "cvssv3_baseScore": 3.3,
                "security-severity": "3.3"
              }
            },
            {
              "id": "SNYK-JAVA-ORGYAML-3152153",
              "shortDescription": {
                "text": "Medium severity - Arbitrary Code Execution vulnerability in org.yaml:snakeyaml"
              },
              "fullDescription": {
                "text": "(CVE-2022-1471) org.yaml:snakeyaml@1.33"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n[org.yaml:snakeyaml](https://code.google.com/p/snakeyaml/source/browse/) is a YAML 1.1 parser and emitter for Java.\n\nAffected versions of this package are vulnerable to Arbitrary Code Execution in the `Constructor` class, which does not restrict which types can be deserialized. This vulnerability is exploitable by an attacker who provides a malicious YAML file for deserialization, which circumvents the `SafeConstructor` class. \r\n\r\nThe maintainers of the library contend that the application's trust would already have had to be compromised or established and therefore dispute the risk associated with this issue on the basis that there is a high bar for exploitation.\n## Remediation\nUpgrade `org.yaml:snakeyaml` to version 2.0 or higher.\n## References\n- [BitBucket Changelog](https://bitbucket.org/snakeyaml/snakeyaml/wiki/Changes)\n- [Bitbucket Commit](https://bitbucket.org/snakeyaml/snakeyaml/commits/2b8d47c8bcfd402e7a682b7b2674e8d0cb25e522)\n- [Bitbucket Issue](https://bitbucket.org/snakeyaml/snakeyaml/issues/561/cve-2022-1471-vulnerability-in)\n- [BitBucket Issue](https://bitbucket.org/snakeyaml/snakeyaml/issues/565/do-not-allow-global-tags-by-default)\n- [BitBucket PR](https://bitbucket.org/snakeyaml/snakeyaml/pull-requests/39)\n- [BitBucket PR](https://bitbucket.org/snakeyaml/snakeyaml/pull-requests/44)\n- [PoC](https://github.com/1fabunicorn/SnakeYAML-CVE-2022-1471-POC)\n- [Snyk Blog - Technical Deepdive](https://snyk.io/blog/unsafe-deserialization-snakeyaml-java-cve-2022-1471/)\n- [Vulnerable Class](https://github.com/snakeyaml/snakeyaml/blob/master/src/main/java/org/yaml/snakeyaml/constructor/Constructor.java)\n"
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-20",
                  "maven"
                ],
                "cvssv3_baseScore": 6.6,
                "security-severity": "6.6"
              }
            },
            {
              "id": "SNYK-JAVA-SOFTWAREAMAZONION-6153869",
              "shortDescription": {
                "text": "High severity - Allocation of Resources Without Limits or Throttling vulnerability in software.amazon.ion:ion-java"
              },
              "fullDescription": {
                "text": "(CVE-2024-21634) software.amazon.ion:ion-java@1.5.1"
              },
              "help": {
                "text": "",
                "markdown": "## Overview\n\nAffected versions of this package are vulnerable to Allocation of Resources Without Limits or Throttling via the deserialization of Ion text encoded data or the `IonValue` model processing. An attacker can cause a `StackOverflowError` by crafting malicious Ion data that triggers excessive resource consumption when loaded or processed. This is only exploitable if the application deserializes Ion data from an untrusted source or data that could have been tampered with.\r\n\r\n**Notes:**\r\n\r\nAccording to the [README.md](https://github.com/amazon-ion/ion-java/blob/ebf8f4d933cc85438e1b309bada90ff0d5a76102/README.md?plain=1#L61) file of this package, its domain changed from `software.amazon.ion` to `com.amazon.ion`. Please be aware that this vulnerability affects versions of both domains of this package.\r\n\r\nFor a fix, please check [the advisory on the maintained package](https://security.snyk.io/vuln/SNYK-JAVA-COMAMAZONION-6143590). \r\n\r\n## Workaround \r\n\r\nThis vulnerability can be mitigated by not loading data from untrusted sources or that could have been tampered with.\n## Remediation\nA fix was pushed into the `master` branch but not yet published.\n## References\n- [GitHub Release](https://github.com/amazon-ion/ion-java/releases/tag/v1.10.5)\n"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-770",
                  "maven"
                ],
                "cvssv3_baseScore": 7.5,
                "security-severity": "7.5"
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "SNYK-JAVA-IONETTY-6483812",
          "level": "warning",
          "message": {
            "text": "This file introduces a vulnerable io.netty:netty-codec-http package with a medium severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/dynamodblocal/DynamoDBLocal_lib"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "io.netty:netty-codec-http@4.1.104.Final"
                }
              ]
            }
          ],
          "fixes": [
            {
              "description": {
                "text": "Upgrade to io.netty:netty-codec-http@4.1.108.Final"
              },
              "artifactChanges": [
                {
                  "artifactLocation": {
                    "uri": "/home/dynamodblocal/DynamoDBLocal_lib"
                  },
                  "replacements": [
                    {
                      "deletedRegion": {
                        "startLine": 1
                      },
                      "insertedContent": {
                        "text": "io.netty:netty-codec-http@4.1.108.Final"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-JAVA-ORGJETBRAINSKOTLIN-2393744",
          "level": "note",
          "message": {
            "text": "This file introduces a vulnerable org.jetbrains.kotlin:kotlin-stdlib package with a low severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/dynamodblocal/DynamoDBLocal_lib"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "org.jetbrains.kotlin:kotlin-stdlib@1.6.21"
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-JAVA-ORGYAML-3152153",
          "level": "warning",
          "message": {
            "text": "This file introduces a vulnerable org.yaml:snakeyaml package with a medium severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/dynamodblocal/DynamoDBLocal_lib"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "org.yaml:snakeyaml@1.33"
                }
              ]
            }
          ]
        },
        {
          "ruleId": "SNYK-JAVA-SOFTWAREAMAZONION-6153869",
          "level": "error",
          "message": {
            "text": "This file introduces a vulnerable software.amazon.ion:ion-java package with a high severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/dynamodblocal/DynamoDBLocal_lib"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "software.amazon.ion:ion-java@1.5.1"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
